* C:\users\lyam\Documents\University\S4\APP4\GitHub\s4-app4\spice\alu_test_trans_delai.asc
XX1 vdd a1 a2 a3 b1 b2 b4 0 o1 o2 o3 sel cout 0 alu params: wn={nnw} wp={nnw*mp} ll={180n} nnw={nnw} mp={mp}
XU1 o1 o2 o3 out Bin2Dec Vhigh={vv}
XU2 b b1 b2 b4 Dec2Bin Vhigh={vv}
XU3 a a1 a2 a3 Dec2Bin Vhigh={vv}
V1 vdd 0 1.8
Va a 0 PULSE(6 3 500p 1p 1p 4000p 8000p 3)
Vb b 0 PULSE(3 5 500p 1p 1p 2000p 4000p 5)
Vsel sel 0 {vv}

* block symbol definitions
.subckt alu vdd a1 a2 a3 b1 b2 b3 vss o1 o2 o3 sel cout cin
XX1 vdd a1 a2 a3 b1 b2 b3 vss N007 N009 N010 N012 cin add3b params: wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
XX2 vdd a1 a2 a3 b1 b2 b3 vss N001 N002 N003 and3b params: wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
XX3 vdd N001 N002 N003 N007 N009 N010 vss N004 N005 N006 sel mux2x3b params: wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
XX6 N004 o1 vdd vss pad_buffer params: wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
XX9 N008 cout vdd vss pad_buffer params: wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
XX4 N005 o2 vdd vss pad_buffer params: wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
XX5 N006 o3 vdd vss pad_buffer params: wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
C5 cout 0 1.5p
C6 o3 0 1.5p
C7 o2 0 1.5p
XX10 sel N011 vdd vss N012 nand params: NAND wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
XX11 N011 N008 vdd vss inv params: wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
C8 o1 0 1.5p
.ends alu

.subckt add3b vdd a1 a2 a3 b1 b2 b3 vss o1 o2 o3 cout cin
XX1 cin a1 b1 o1 N001 vdd vss add1b params: ll={ll} wn={nnw} wp={nnw*mp}
XX2 N001 a2 b2 o2 N002 vdd vss add1b params: ll={ll} wn={nnw} wp={nnw*mp}
XX3 N002 a3 b3 o3 cout vdd vss add1b params: ll={ll} wn={nnw} wp={nnw*mp}
.ends add3b

.subckt and3b vdd a1 a2 a3 b1 b2 b3 vss o1 o2 o3
XX1 a1 N001 vdd vss b1 nand params: NAND wn={nnw} wp={nnw*mp} ll={ll}
XX2 a2 N002 vdd vss b2 nand params: NAND wn={nnw} wp={nnw*mp} ll={ll}
XX3 a3 N003 vdd vss b3 nand params: NAND wn={nnw} wp={nnw*mp} ll={ll}
XX4 N001 o1 vdd vss inv params: wn={nnw} wp={nnw*mp} ll={ll}
XX5 N002 o2 vdd vss inv params: wn={nnw} wp={nnw*mp} ll={ll}
XX6 N003 o3 vdd vss inv params: wn={nnw} wp={nnw*mp} ll={ll}
.ends and3b

.subckt mux2x3b vdd a1 a2 a3 b1 b2 b3 vss o1 o2 o3 sel
XX4 a1 b1 sel o1 vdd vss mux2x1b params: wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
XX5 a2 b2 sel o2 vdd vss mux2x1b params: wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
XX6 a3 b3 sel o3 vdd vss mux2x1b params: wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
.ends mux2x3b

.subckt pad_buffer In out vdd vss
R1 N002 N004 1
R2 N002 N001 1
R3 N002 N003 1
XX1 in N006 vdd vss inv params: ll=180n wn={nnw} wp={nnw*mp}
XX2 N006 N007 vdd vss inv params: ll=180n wn={nnw*fac} wp={nnw*mp*fac}
XX3 N007 N008 vdd vss inv params: ll=180n wn={nnw*fac*fac} wp={nnw*mp*fac*fac}
XX4 N008 N009 vdd vss inv params: ll=180n wn={nnw*fac*fac*fac} wp={nnw*mp*fac*fac*fac}
XX5 N009 N010 vdd vss inv params: ll=180n wn={nnw*fac*fac*fac*fac} wp={nnw*mp*fac*fac*fac*fac}
XX6 N010 out vdd vss inv params: ll=180n wn={nnw*fac*fac*fac*fac*fac} wp={nnw*mp*fac*fac*fac*fac*fac}
XX7 vss N005 vdd vss inv params: ll=180n wn={nnw*fac*fac*fac*fac*fac*fac} wp={nnw*mp*fac*fac*fac*fac*fac*fac}
XX8 N005 P001 vdd vss inv params: ll=180n wn={nnw*fac*fac*fac*fac*fac*fac*fac} wp={nnw*mp*fac*fac*fac*fac*fac*fac*fac}
R4 vss P001 1
.param wpad=360u fac=3.38
.lib BU_180nm.lib
.ends pad_buffer

.subckt nand in1 Q vdd vss in2
R2 vdd N002 1
M1 vdd in1 Q vdd PMOS l={ll} w={wp} ad={450n*{wp}} as={450n*{wp}} pd={900n+{wp}} ps={1080n+{wp}}
M2 Q in1 N005 vss NMOS l={ll} w={wn*2} ad={450n*{wn}} as={450n*{wn}} pd={900n+{wn}} ps={1080n+{wn}}
M3 vdd in2 Q vdd PMOS l={ll} w={wp} ad={450n*{wp}} as={450n*{wp}} pd={900n+{wp}} ps={1080n+{wp}}
M4 N005 in2 vss vss NMOS l={ll} w={wn*2} ad={450n*{wn}} as={450n*{wn}} pd={900n+{wn}} ps={1080n+{wn}}
.lib BU_180nm.lib
.ends nand

.subckt inv In _Q vdd vss
M1 _Q In vss vss NMOS l={ll} w={wn} ad={450n*{wn}} as={450n*{wn}} pd={900n+{wn}} ps={1080n+{wn}}
M2 vdd In _Q vdd PMOS l={ll} w={wp} ad={450n*{wp}} as={450n*{wp}} pd={900n+{wp}} ps={1080n+{wp}}
.lib BU_180nm.lib
.ends inv

.subckt add1b cin a b s cout vss vdd
XX1 b N001 vss vdd a nand params: NAND wn={nnw} wp={nnw*mp} ll={ll}
XX2 cin N002 vss vdd N003 nand params: NAND wn={nnw} wp={nnw*mp} ll={ll}
XX3 b N003 vss vdd a xor params: XOR ll={ll} wn={nnw*2} wp={nnw*mp*2}
XX4 N002 cout vss vdd N001 nand params: NAND wn={nnw} wp={nnw*mp} ll={ll}
XX5 cin s vss vdd N003 xor params: XOR ll={ll} wn={nnw*2} wp={nnw*mp*2}
.ends add1b

.subckt mux2x1b a b sel o vss vdd
XX1 sel N001 vss vdd inv params: wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
XX2 N001 N002 vss vdd a nand params: NAND wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
XX3 sel N003 vss vdd b nand params: NAND wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
XX4 N003 o vss vdd N002 nand params: NAND wn={nnw} wp={nnw*mp} ll={ll} nnw={nnw} mp={mp}
.ends mux2x1b

.subckt xor in1 Q vdd vss in2
M9 Q in1 N006 vss NMOS l={ll} w={wn*2} ad={450n*{wn}} as={450n*{wn}} pd={900n+{wn}} ps={1080n+{wn}}
M10 vdd N001 N003 vdd PMOS l={ll} w={wp*2} ad={450n*{wp}} as={450n*{wp}} pd={900n+{wp}} ps={1080n+{wp}}
M5 vdd N002 N004 vdd PMOS l={ll} w={wp*2} ad={450n*{wp}} as={450n*{wp}} pd={900n+{wp}} ps={1080n+{wp}}
M6 N003 in2 Q vdd PMOS l={ll} w={wp*2} ad={450n*{wp}} as={450n*{wp}} pd={900n+{wp}} ps={1080n+{wp}}
M7 N004 in1 Q vdd PMOS l={ll} w={wp*2} ad={450n*{wp}} as={450n*{wp}} pd={900n+{wp}} ps={1080n+{wp}}
M1 Q N005 N007 vss NMOS l={ll} w={wn*2} ad={450n*{wn}} as={450n*{wn}} pd={900n+{wn}} ps={1080n+{wn}}
M2 N006 in2 vss vss NMOS l={ll} w={wn*2} ad={450n*{wn}} as={450n*{wn}} pd={900n+{wn}} ps={1080n+{wn}}
M3 N007 N008 vss vss NMOS l={ll} w={wn*2} ad={450n*{wn}} as={450n*{wn}} pd={900n+{wn}} ps={1080n+{wn}}
M4 vdd in1 N001 vdd PMOS l={ll} w={wp*1} ad={450n*{wp}} as={450n*{wp}} pd={900n+{wp}} ps={1080n+{wp}}
M8 N001 in1 vss vss NMOS l={ll} w={wn*1} ad={450n*{wn}} as={450n*{wn}} pd={900n+{wn}} ps={1080n+{wn}}
M11 vdd in2 N002 vdd PMOS l={ll} w={wp*1} ad={450n*{wp}} as={450n*{wp}} pd={900n+{wp}} ps={1080n+{wp}}
M12 N002 in2 vss vss NMOS l={ll} w={wn*1} ad={450n*{wn}} as={450n*{wn}} pd={900n+{wn}} ps={1080n+{wn}}
M13 vdd in2 N005 vdd PMOS l={ll} w={wp} ad={450n*{wp}} as={450n*{wp}} pd={900n+{wp}} ps={1080n+{wp}}
M14 N005 in2 vss vss NMOS l={ll} w={wn} ad={450n*{wn}} as={450n*{wn}} pd={900n+{wn}} ps={1080n+{wn}}
M15 vdd in1 N008 vdd PMOS l={ll} w={wp*1} ad={450n*{wp}} as={450n*{wp}} pd={900n+{wp}} ps={1080n+{wp}}
M16 N008 in1 vss vss NMOS l={ll} w={wn*1} ad={450n*{wn}} as={450n*{wn}} pd={900n+{wn}} ps={1080n+{wn}}
.lib BU_180nm.lib
.param wn1={wn*3}
.param wp2={wp*3}
.ends xor

.model NMOS NMOS
.model PMOS PMOS
.lib C:\users\lyam\Documents\LTspiceXVII\lib\cmp\standard.mos
.param vv=1.8 nnw=180n mp=2.5
.lib BU_180nm.lib
.tran 0 20n 0 10p
* sel = 0: AND\n     = 1: ADD
.meas tran t1 find time when v(o1)=vv*0.1 rise 1
.meas tran t2 find time when v(o1)=vv*0.9 rise 1
.meas tran t3 find time when v(o1)=vv*0.1 fall 1
.meas tran t4 find time when v(o1)=vv*0.9 fall 1
.meas tran t5 find time when v(a1)=vv*0 rise 1
.meas tran transition_up param abs(t2-t1)
.meas tran transition_down param abs(t4-t3)
.meas tran ratio param transition_up/transition_down
.meas tran moy param (transition_up+transition_down)/2
.meas tran propagation param abs(t5-t2)
.meas tran t6 find time when v(a1)=vv*0.1 fall 1
.meas tran propagationFall param abs(t6-t3)
.lib Bin2Dec.sub
.lib Dec2Bin.sub
.backanno
.end
